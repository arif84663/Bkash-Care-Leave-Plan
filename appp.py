import streamlit as st
import pandas as pd
from datetime import date

# ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶≤‡ßá‡¶Ü‡¶â‡¶ü
st.set_page_config(page_title="Employee Management", layout="centered")

st.title("üíº ‡¶è‡¶Æ‡¶™‡ßç‡¶≤‡¶Ø‡¶º‡ßÄ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ")

# ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ (‡¶∏‡ßá‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡ßá‡¶ü)
if 'leave_requests' not in st.session_state:
    st.session_state.leave_requests = []

# ‡¶è‡¶Æ‡¶™‡ßç‡¶≤‡¶Ø‡¶º‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶°‡¶æ‡¶Æ‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ
employees = {
    "E001": {"name": "‡¶Ü‡¶∞‡¶ø‡¶´ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®", "post": "‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞"},
    "E002": {"name": "‡¶∏‡¶æ‡¶∞‡¶æ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ", "post": "‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞"}
}

# ‡¶∏‡¶æ‡¶á‡¶°‡¶¨‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶®‡ßÅ
menu = ["‡¶π‡ßã‡¶Æ", "‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®", "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤"]
choice = st.sidebar.selectbox("‡¶Æ‡ßá‡¶®‡ßÅ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®", menu)

# --- ‡¶π‡ßã‡¶Æ ‡¶™‡ßá‡¶ú ---
if choice == "‡¶π‡ßã‡¶Æ":
    st.subheader("‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!")
    st.write("‡¶¨‡¶æ‡¶Æ ‡¶™‡¶æ‡¶∂‡ßá‡¶∞ ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶•‡ßá‡¶ï‡ßá ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶¨‡¶æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§")

# --- ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ---
elif choice == "‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®":
    st.subheader("‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶´‡¶∞‡¶Æ")
    with st.form("leave_form"):
        emp_id = st.text_input("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø (‡¶Ø‡ßá‡¶Æ‡¶®: E001)")
        l_type = st.selectbox("‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ß‡¶∞‡¶®", ["‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ", "‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§", "‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ"])
        s_date = st.date_input("‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ", date.today())
        e_date = st.date_input("‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ", date.today())
        reason = st.text_area("‡¶ï‡¶æ‡¶∞‡¶£")
        
        submit = st.form_submit_button("‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶æ‡¶†‡¶æ‡¶®")
        
        if submit:
            if emp_id in employees:
                st.session_state.leave_requests.append({
                    "‡¶Ü‡¶á‡¶°‡¶ø": emp_id,
                    "‡¶®‡¶æ‡¶Æ": employees[emp_id]['name'],
                    "‡¶ß‡¶∞‡¶®": l_type,
                    "‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ": f"{s_date} ‡¶•‡ßá‡¶ï‡ßá {e_date}",
                    "‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ": "Pending"
                })
                st.success("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶ü‡¶ø ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!")
            else:
                st.error("‡¶≠‡ßÅ‡¶≤ ‡¶Ü‡¶á‡¶°‡¶ø! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§")

# --- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ---
elif choice == "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤":
    st.subheader("‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶∏‡¶Æ‡ßÇ‡¶π‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ")
    if len(st.session_state.leave_requests) > 0:
        df = pd.DataFrame(st.session_state.leave_requests)
        st.table(df)
    else:
        st.info("‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶ú‡¶Æ‡¶æ ‡¶™‡¶°‡¶º‡ßá‡¶®‡¶ø‡•§")
